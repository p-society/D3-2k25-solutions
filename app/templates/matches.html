{% extends "base.html" %}

{% block title %}Matches - SWAPP{% endblock %}

{% block content %}
<h1 class="mb-4"><i class="fas fa-users"></i> Your Matches</h1>

<div class="row">
    {% for match in matches %}
        {% set other_user = match.user2 if match.user1_id == current_user.id else match.user1 %}
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div>
                            <h4>{{ other_user.username }}</h4>
                            <span class="trust-score">
                                <i class="fas fa-star"></i> {{ other_user.trust_score }}
                            </span>
                        </div>
                        <div class="match-percentage">{{ match.match_percentage }}%</div>
                    </div>
                    
                    {% if match.is_double_swap %}
                        <div class="alert alert-info">
                            <i class="fas fa-exchange-alt"></i> <strong>Perfect Double Swap!</strong>
                            You can teach each other!
                        </div>
                    {% endif %}
                    
                    <div class="row">
                        <div class="col-6">
                            <h6 class="text-success">They Offer:</h6>
                            <p class="small">{{ match.user2_offers if match.user1_id == current_user.id else match.user1_offers }}</p>
                        </div>
                        <div class="col-6">
                            <h6 class="text-primary">They Want:</h6>
                            <p class="small">{{ match.user2_wants if match.user1_id == current_user.id else match.user1_wants }}</p>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <a href="{{ url_for('schedule_session', match_id=match.id) }}" class="btn btn-primary btn-sm">
                            <i class="fas fa-calendar-plus"></i> Schedule Session
                        </a>
                        <a href="{{ url_for('chat', user_id=other_user.id) }}" class="btn btn-success btn-sm">
                            <i class="fas fa-comment"></i> Message
                        </a>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <div class="col-md-12">
            <div class="alert alert-info">
                <h5>No matches found yet!</h5>
                <p>Add more skills to your profile to find potential learning partners.</p>
                <a href="{{ url_for('profile') }}" class="btn btn-primary">Add Skills</a>
            </div>
        </div>
    {% endfor %}
</div>
{% endblock %}
